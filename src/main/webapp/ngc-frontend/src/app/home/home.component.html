<div class="broker-container">
  <h2>Depotübersicht</h2>
  <p>In diesem Bereich finden Sie eine Auflistung Ihrer aktuellen Depotpositionen.</p>

  <div *ngIf="isLoading">Loading...</div>
  <div *ngIf="!isLoading&&!keineDepots">
    <table class="table-transaktionen">
      <thead>
        <tr>
          <th (click)="sortTable('isin')">ISIN</th>
          <th (click)="sortTable('anzahl')">Anzahl</th>
          <th (click)="sortTable('einstandspreis')">Einstandspreis</th>
          <th (click)="sortTable('currentPrice')">Aktueller Wert</th>
          <th (click)="sortTable('changeTotal')">Wertänderung - Total</th>
          <th (click)="sortTable('changeProzent')">Wertänderung - Prozentual</th>
          <th>Handeln</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of depots">
          <td>{{ item.isin }}</td>
          <td>{{ item.anzahl }}</td>
          <td>{{ item.einstandspreis }}$</td>
          <td>{{ item.currentPrice }}$</td>
          <td>{{ item.changeTotal}}$</td>


          <td>
            <span class="change-text"
              [ngClass]="{'positive': item.changeProzent> 0, 'negative': item.changeProzent < 0}">
              {{ item.changeProzent }}%
            </span>
          </td>
          <td>
            <button class="sell-button" (click)="openSellPopup(item)">Aktie verkaufen</button>
          </td>
        </tr>
      </tbody>
      <tfoot>
        <tr>
          <td colspan="4">Gesamtveränderung</td>
          <td>{{ totalChangeTotal() }}$</td>
          <td>{{ totalChangeProzent() }}%</td>
          <td></td> <!-- Platzhalter für die Handeln-Spalte -->
        </tr>
      </tfoot>

    </table>
  </div>
  <div *ngIf="!isLoading&&keineDepots">
    <p>Sie haben noch keine Aktien im Depot.</p>
  </div>
</div>



<div class="broker-container">
  <h2>Analyse</h2>
  <div class="chart-container" *ngIf="!keineDepots">
    <canvas id="portfolioDistributionChart"></canvas>
    <!-- Gesamtpreis -->

  </div>
  <div *ngIf="keineDepots">
    <p>Da Sie keine Aktien im Depot haben ist keine Analyse möglich.</p>
  </div>
</div>

<div class="broker-container">
  <h2>Gesamtwert des Portfolios</h2>
  <p style="font-size: larger; font-weight: bold;">{{calculatePortfolioValue() | number}}$</p>
</div>



